/*!
    ko-formatter - knockout input auto formatter
    Author: Matthew Nitschke
    License: MIT (http://www.opensource.org/licenses/mit-license.php)
    Version: 1.0.0
*/
!function(t,r){function e(t,r){if(t.setSelectionRange)t.focus(),t.setSelectionRange(r,r);else if(t.createTextRange){var e=t.createTextRange();e.collapse(!0),e.moveEnd("character",r),e.moveStart("character",r),e.select()}}var n=[{wildcard:"#",isValid:function(t){return!isNaN(parseInt(t))}},{wildcard:"@",isValid:function(t){return!!t.match(/[a-z]/i)}},{wildcard:"*",isValid:function(t){return!0}}];ko.bindingHandlers.formatter={init:function(t,r,e,n,a){var i,o=e();o.textInput?i=o.textInput:o.value&&(i=o.value);var c,u=o.formatter;c="string"==typeof u?function(){ko.bindingHandlers.formatter.formatPattern(t,i,u)}:function(){ko.bindingHandlers.formatter.format(t,i,u)},i.subscribe(c),c()},formatPattern:function(t,r,a){function i(t,r,e){var n=r.substring(0,t),a=e.substring(0,t),i=n.match(o(a));return i?i.length:null}function o(t){var r=t.replace(c(),"");return new RegExp("["+r+"]","gi")}function c(){for(var t="",r=0;r<n.length;r++)t+=n[r].wildcard;return new RegExp("["+t+"]","gi")}var u=r;if(r=ko.unwrap(r)){var f=t.selectionStart,l=function(t,r){var e=r.search(c());if(r=r.split(""),e>-1){for(var a=0;a<n.length;a++)n[a].wildcard==r[e]&&(n[a].isValid(t.charAt(0))?r[e]=t.charAt(0):(f--,1===t.length&&(r[e]="")),t=t.substring(1,t.length));return t.length>0?l(t,r.join("")):r.splice(0,e+1).join("")}return r.join("")},s=function(t,r){if(t){var e=r.replace(c(),"");if(t=t.replace(new RegExp("["+e+"]","gi"),""))return l(t,r)}}(r,a),g=i(f,r,a),p=i(f,s,a),d=f+(p-g);u(s),e(t,d)}},format:function(t,r,n){function a(t,r){if(n.patternCharacters){var e=new RegExp("["+n.patternCharacters+"]","gi"),a=t.substring(0,r).match(e);return a?a.length:0}return 0}var i=ko.unwrap(r),o=t.selectionStart;if(i||n.allowNull){i.length>n.lengthLimit&&(i=i.substring(0,n.lengthLimit));var c=a(i,o);null!=n.preformatter&&(i=n.preformatter(i)),n.formatterFunction&&(i=n.formatterFunction(i));o+=a(i,o)-c}r(i),e(t,o)}};var a=function(t){return t.replace(/\D+/g,"")},i=function(t){return t.replace(/[^a-z]/gi,"")};ko.formatter={date:"##/##/####",zip:"#####",ssn:"###-##-####",phone:"###-###-####",phoneNoAreaCode:"###-####",creditCardNumber:"#### #### #### ####",creditCardCVC:"###",creditCardDate:"##/##",bankRoutingNumber:"#########",bankAccountNumber:"#################",money:{formatterFunction:function(t){t=t.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");var r=t.match(/(\..{2})/);return r&&(t=t.replace(/(\..{2}).+/g,r[0])),t="$"+t},patternCharacters:"$,",allowNull:!1,preformatter:function(t){return t.replace(/[^0-9.]/g,"")}},state:{formatterFunction:function(t){return t.toUpperCase()},lengthLimit:2,preforatter:i},numbers:{preformatter:a},characters:{preformatter:i},capitalize:{formatterFunction:function(t){return t=t.replace(/\b(\w)/g,function(t){return t.toUpperCase()})}},oneWord:{formatterFunction:function(t){return t=t.match(/(.)[^ ]*/),t?t[0]:""}}}}();