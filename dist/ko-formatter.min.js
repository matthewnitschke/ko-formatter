/*!
    ko-formatter - knockout input auto formatter
    Author: Matthew Nitschke
    License: MIT (http://www.opensource.org/licenses/mit-license.php)
    Version: 1.0.0
*/
!function(t,r){function n(t,r){if(t.setSelectionRange)t.focus(),t.setSelectionRange(r,r);else if(t.createTextRange){var n=t.createTextRange();n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",r),n.select()}}var e=[{wildcard:"#",isValid:function(t){return!isNaN(parseInt(t))}},{wildcard:"@",isValid:function(t){return t.match(/[a-z]/i)}},{wildcard:"*",isValid:function(t){return!0}}];ko.bindingHandlers.formatter={init:function(t,r,n,e,a){var i,o=n();o.textInput?i=o.textInput:o.value&&(i=o.value);var c=r();if(""!=c){var u;u="string"==typeof c?function(){ko.bindingHandlers.formatter.formatPattern(t,i,c)}:function(){ko.bindingHandlers.formatter.format(t,i,c)},i.formattingSubscription=i.subscribe(u),i.formatterFunction=u,u()}},formatPattern:function(t,r,a){function i(t,r,n){var e=r.substring(0,t),a=n.substring(0,t),i=e.match(o(a));return i?i.length:null}function o(t){var r=t.replace(c(),"");return new RegExp("["+r+"]","gi")}function c(){for(var t="",r=0;r<e.length;r++)t+=e[r].wildcard;return new RegExp("["+t+"]","gi")}var u=r;if(r=ko.unwrap(r)){var f=t.selectionEnd,l=function(t,r){var n=r.search(c());if(r=r.split(""),n>-1){for(var a=0;a<e.length;a++)e[a].wildcard==r[n]&&(e[a].isValid(t.charAt(0))?r[n]=t.charAt(0):(f--,1===t.length&&(r[n]="")),t=t.substring(1,t.length));return t.length>0?l(t,r.join("")):r.splice(0,n+1).join("")}return r.join("")},s=function(t,r){if(t){var n=r.replace(c(),"");if(t=t.replace(new RegExp("["+n+"]","gi"),""))return l(t,r)}}(r,a),p=i(f,r,a),g=i(f,s,a),m=f+(g-p),d=u()!=s;d&&(u.formattingSubscription,u.formattingSubscription.dispose()),u(s),d&&(u.formattingSubscription=u.subscribe(u.formatterFunction)),setTimeout(function(){n(t,m)},0)}},format:function(t,r,e){function a(t,r){if(e.patternCharacters){var n=new RegExp("["+e.patternCharacters+"]","gi"),a=t.substring(0,r).match(n);return a?a.length:0}return 0}var i=ko.unwrap(r),o=t.selectionEnd;if(i||e.allowNull){i.length>e.lengthLimit&&(i=i.substring(0,e.lengthLimit));var c=a(i,o);null!=e.preformatter&&(i=e.preformatter(i)),e.formatterFunction&&(i=e.formatterFunction(i));var u=a(i,o);o+=u-c}t.value=i,setTimeout(function(){n(t,o)},0)}};var a=function(t){return t.replace(/\D+/g,"")},i=function(t){return t.replace(/[^a-z]/gi,"")};ko.formatter={date:"##/##/####",zip:"#####",ssn:"###-##-####",phone:"###-###-####",phoneNoAreaCode:"###-####",creditCardNumber:"#### #### #### ####",creditCardCVC:"###",creditCardDate:"##/##",bankRoutingNumber:"#########",bankAccountNumber:"#################",money:{formatterFunction:function(t){t=t.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");var r=t.match(/(\..{2})/);return r&&(t=t.replace(/(\..{2}).+/g,r[0])),t="$"+t},patternCharacters:"$,",allowNull:!1,preformatter:function(t){return t.replace(/[^0-9.]/g,"")}},state:{formatterFunction:function(t){return t.toUpperCase()},lengthLimit:2,preforatter:i},numbers:{preformatter:a},characters:{preformatter:i},capitalize:{formatterFunction:function(t){return t=t.replace(/\b(\w)/g,function(t){return t.toUpperCase()})}},oneWord:{formatterFunction:function(t){return t=t.match(/(.)[^ ]*/),t?t[0]:""}}}}();